<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriInfo Kenya | Farmer's Digital Companion</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4CAF50">
    <meta name="description" content="Offline-first agricultural platform for Kenyan farmers with marketplace, tools, and real-time data.">
    
    <!-- Apple PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Offline Indicator -->
    <div id="offline-indicator" class="offline-banner">
        <span>âš ï¸ You are offline. Working in offline mode.</span>
    </div>

    <!-- App Header -->
    <header class="app-header">
        <div class="header-content">
            <div class="logo-section">
                <h1 class="logo">ğŸŒ± AgriInfo Kenya</h1>
                <p class="tagline">Empowering Kenyan Farmers Digitally</p>
            </div>
            
            <div class="header-stats">
                <div class="stat-item">
                    <span id="connection-status" class="status online">Online</span>
                </div>
                <div class="stat-item">
                    <span id="data-updated">Just now</span>
                </div>
                <button id="sync-btn" class="btn-sync">
                    ğŸ”„ <span id="sync-status">Sync</span>
                </button>
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="main-nav">
            <a href="#home" class="nav-link active">ğŸ  Home</a>
            <a href="#crops" class="nav-link">ğŸŒ¾ Crops</a>
            <a href="#pest" class="nav-link">ğŸ› Pest Control</a>
            <a href="#market" class="nav-link">ğŸ’° Marketplace</a>
            <a href="#tools" class="nav-link">ğŸ› ï¸ Tools</a>
            <a href="#profile" class="nav-link">ğŸ‘¤ Profile</a>
        </nav>
    </header>

    <!-- Main App Container -->
    <main class="app-container">
        <!-- Home Section -->
        <section id="home" class="section active">
            <div class="hero-section">
                <h2>Welcome to AgriInfo Kenya</h2>
                <p>Your digital companion for modern farming in Kenya</p>
                
                <div class="quick-stats">
                    <div class="stat-card">
                        <h3 id="crop-count">0 crops</h3>
                        <p>In Database</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="storage-status">Ready</h3>
                        <p>Storage Status</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="last-sync">Never</h3>
                        <p>Last Sync</p>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button id="load-data" class="btn-primary">ğŸ“¥ Load Sample Data</button>
                <button id="clear-cache" class="btn-secondary">ğŸ§¹ Clear Cache</button>
                <button id="export-data" class="btn-secondary">ğŸ“¤ Export Data</button>
            </div>

            <!-- User Profile Summary -->
            <div id="user-profile" class="user-profile-card"></div>

            <!-- Quick Tools -->
            <div class="quick-tools">
                <h3>ğŸ› ï¸ Quick Tools</h3>
                <div class="tools-grid">
                    <button class="tool-btn" onclick="agriApp.showSection('tools')">
                        ğŸ’§ Water Calculator
                    </button>
                    <button class="tool-btn" onclick="agriApp.showSection('tools')">
                        ğŸŒ± Seed Calculator
                    </button>
                    <button class="tool-btn" onclick="agriApp.showSection('market')">
                        ğŸ’° Market Prices
                    </button>
                    <button id="get-weather" class="tool-btn">
                        ğŸŒ¤ï¸ Weather Check
                    </button>
                </div>
            </div>
        </section>

        <!-- Crops Section -->
        <section id="crops" class="section">
            <h2>ğŸŒ¾ Crop Information</h2>
            
            <div class="search-container">
                <input type="text" id="crop-search" placeholder="Search crops (e.g., Maize, Beans)...">
                <button id="search-btn" class="btn-primary">Search</button>
            </div>
            
            <div id="crops-container" class="crops-grid"></div>
        </section>

        <!-- Pest Control Section -->
        <section id="pest" class="section">
            <h2>ğŸ› Pest & Disease Control</h2>
            <div id="pest-container" class="pest-grid"></div>
        </section>

        <!-- Marketplace Section -->
        <section id="market" class="section">
            <h2>ğŸ’° Farmer's Marketplace</h2>
            <p class="section-subtitle">Buy and sell produce directly with other farmers</p>
            
            <!-- Marketplace UI will be injected here by JavaScript -->
            <div id="marketplace-container"></div>
        </section>

        <!-- Tools Section -->
        <section id="tools" class="section">
            <h2>ğŸ› ï¸ Farming Tools</h2>
            
            <div class="tools-container">
                <!-- Seed Calculator -->
                <div class="tool-card">
                    <h3>ğŸŒ± Seed Calculator</h3>
                    <div class="input-group">
                        <label>Land Area (acres):</label>
                        <input type="number" id="land-area" placeholder="e.g., 5" min="0.1" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Crop Type:</label>
                        <select id="crop-type">
                            <option value="maize">Maize</option>
                            <option value="wheat">Wheat</option>
                            <option value="rice">Rice</option>
                            <option value="beans">Beans</option>
                        </select>
                    </div>
                    <button id="calculate-seed" class="btn-primary">Calculate</button>
                    <div class="result" id="seed-result"></div>
                </div>

                <!-- Water Calculator -->
                <div class="tool-card">
                    <h3>ğŸ’§ Water Calculator</h3>
                    <div class="input-group">
                        <label>Area (acres):</label>
                        <input type="number" id="water-area" placeholder="e.g., 5" min="0.1" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Soil Type:</label>
                        <select id="soil-type">
                            <option value="clay">Clay</option>
                            <option value="loam">Loam</option>
                            <option value="sandy">Sandy</option>
                        </select>
                    </div>
                    <button id="calculate-water" class="btn-primary">Calculate</button>
                    <div class="result" id="water-result"></div>
                </div>

                <!-- Weather Check -->
                <div class="tool-card">
                    <h3>ğŸŒ¤ï¸ Weather Check</h3>
                    <p>Get current weather conditions for your location</p>
                    <button id="get-weather-tool" class="btn-primary">Check Weather</button>
                    <div id="weather-data" class="weather-info"></div>
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profile" class="section">
            <h2>ğŸ‘¤ Farmer Profile</h2>
            <div id="profile-container" class="profile-container">
                <!-- Profile will be loaded dynamically -->
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="app-footer">
        <p>ğŸŒ± AgriInfo Kenya | Made for Kenyan Farmers | Offline-First PWA</p>
        <p class="footer-links">
            <a href="#" onclick="agriApp.exportData()">Export Data</a> | 
            <a href="#" onclick="agriApp.clearCache()">Clear Cache</a> | 
            <a href="#home">Home</a>
        </p>
    </footer>

    <!-- JavaScript Files -->
    <script src="js/db.js"></script>
    <script src="js/sync.js"></script>
    <script src="js/app.js"></script>
    
    <!-- PWA Registration -->
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(reg => console.log('Service Worker registered:', reg))
                .catch(err => console.log('Service Worker registration failed:', err));
        }
        
        // Install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button
            const installBtn = document.createElement('button');
            installBtn.textContent = 'ğŸ“² Install App';
            installBtn.className = 'install-btn';
            installBtn.onclick = () => {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(() => {
                    deferredPrompt = null;
                });
            };
            document.querySelector('.app-footer').prepend(installBtn);
        });
    </script>
</body>
</html>